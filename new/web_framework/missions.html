<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missions - Courier</title>
    <link rel="stylesheet" href="assets/css/design-system.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/inventory.css">
    <link rel="stylesheet" href="assets/css/missions.css">
</head>
<body>
    <!-- Navigation Header -->
    <nav class="navbar">
        <div class="nav-brand">
            <div class="nav-logo"></div>
            <div>
                <div class="nav-username">AGENT RECON-7</div>
                <div class="nav-level">LEVEL 60 ‚Ä¢ PARAGON 40</div>
            </div>
        </div>
        <div class="nav-menu">
            <a href="dashboard.html" class="nav-item">CHARACTER</a>
            <a href="inventory.html" class="nav-item">INVENTORY</a>
            <a href="missions.html" class="nav-item active">MISSIONS</a>
            <a href="skills.html" class="nav-item">SKILLS</a>
            <a href="loadouts.html" class="nav-item">LOADOUTS</a>
            <a href="build-planner.html" class="nav-item">BUILD PLANNER</a>
            <a href="marketplace.html" class="nav-item">MARKET</a>
            <a href="crafting.html" class="nav-item">CRAFTING</a>
        </div>
    </nav>

    <!-- Missions Content -->
    <div class="page-container">
        <div class="page-header">
            <h1 class="page-title">MISSION OPERATIONS</h1>
        </div>
        
        <div class="layout-sidebar">
            <!-- Mission Categories Sidebar -->
            <div class="sidebar">
                <div class="card-header">
                    <h3 class="card-title">Mission Types</h3>
                </div>
                <div class="card-accent"></div>
                
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link active" data-category="patrol">
                            üîç PATROL
                            <span style="float: right; font-size: 10px; color: var(--text-dim);">15-30 min</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" data-category="horde">
                            ‚ö° HORDE
                            <span style="float: right; font-size: 10px; color: var(--text-dim);">45-90 min</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a href="#" class="sidebar-link" data-category="expedition">
                            üöÄ EXPEDITION
                            <span style="float: right; font-size: 10px; color: var(--text-dim);">2-4 hours</span>
                        </a>
                    </li>
                </ul>
                
                <div style="margin-top: var(--spacing-xl);">
                    <div class="card-header">
                        <h4 class="card-title">Weekly Affixes</h4>
                    </div>
                    <div class="card-accent"></div>
                    
                    <div class="stat-group">
                        <div class="stat-item">
                            <div class="stat-label">
                                <span class="stat-icon">‚ùÑÔ∏è</span>
                                FROZEN GROUND
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">
                                <span class="stat-icon">‚ö°</span>
                                ELECTRIC STORM
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">
                                <span class="stat-icon">üî•</span>
                                SCORCHED EARTH
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Mission Selection Area -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Available Missions</h2>
                    <div style="display: flex; gap: var(--spacing-lg); align-items: center;">
                        <span class="text-dim">Power: <span class="text-cyan power-value">1850</span>/2140</span>
                        <span class="text-dim">Success Rate: <span class="text-cyan">87%</span></span>
                        <button class="btn btn-primary">REFRESH</button>
                    </div>
                </div>
                <div class="card-accent"></div>
                
                <div class="mission-grid" id="mission-grid">
                    <div class="page-loader">
                        <p>Loading missions...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- Mission Success Modal -->
        <div class="mission-success-overlay hidden" id="mission-success-overlay">
            <div class="mission-success-modal">
                <div class="success-header">
                    <div class="success-title">MISSION SUCCESS</div>
                    <div class="success-mission-name" id="success-mission-name">Mission Name</div>
                    <div class="success-stats">
                        <div class="success-stat">
                            <div class="success-stat-value" id="success-duration">--</div>
                            <div>Duration</div>
                        </div>
                        <div class="success-stat">
                            <div class="success-stat-value" id="success-efficiency">--</div>
                            <div>Efficiency</div>
                        </div>
                        <div class="success-stat">
                            <div class="success-stat-value" id="success-rating">--</div>
                            <div>Rating</div>
                        </div>
                    </div>
                </div>

                <div class="success-body">
                    <div class="rewards-section">
                        <div class="currency-rewards">
                            <div class="currency-item">
                                <div class="currency-icon">üí∞</div>
                                <div class="currency-amount" id="success-credits">0</div>
                                <div class="currency-label">Credits</div>
                            </div>
                            <div class="currency-item">
                                <div class="currency-icon">‚≠ê</div>
                                <div class="currency-amount" id="success-xp">0</div>
                                <div class="currency-label">XP</div>
                            </div>
                        </div>

                        <div class="rewards-header">MISSION REWARDS</div>
                        <div class="item-rewards-grid" id="item-rewards-grid">
                            <!-- Item rewards will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="success-footer">
                    <button class="success-button primary" onclick="collectRewards()">COLLECT REWARDS</button>
                    <button class="success-button" onclick="closeMissionSuccess()">CONTINUE</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="padding: 20px; text-align: center; font-size: 10px; color: #666; border-top: 1px solid #333; margin-top: 40px;">
        <a href="changelog.html" style="color: #666; text-decoration: none; border-bottom: 1px dotted #666;">CHANGELOG</a> ‚Ä¢ 
        <a href="specs/index.html" style="color: #666; text-decoration: none; border-bottom: 1px dotted #666;">SPECS</a> ‚Ä¢ 
        <a href="tuning/index.html" style="color: #666; text-decoration: none; border-bottom: 1px dotted #666;">TUNING</a> ‚Ä¢ 
        LAST UPDATED: 2025-08-16 11:52 PM CST ‚Ä¢ MISSIONS: Complete timer-based gameplay ‚Ä¢ SPECS: Complete documentation system
    </footer>

    <!-- Initialize global game state -->
    <script>
        window.CourierGame = {
            data: {
                items: {},
                playerLevel: 60,
                paragonLevel: 40
            }
        };
    </script>
    <script src="assets/js/api-client-v4.js"></script>
    <script src="assets/js/character-header.js"></script>
    <script src="assets/js/tooltips.js"></script>
    <script src="assets/js/inventory-simple.js"></script>
    <script src="assets/js/missions.js"></script>
    <script>
        // Initialize missions directly
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('Standalone missions page loaded');
            
            // Test API connection
            try {
                const health = await window.CourierAPI.healthCheck();
                console.log('API Health Check SUCCESS:', health);
            } catch (error) {
                console.error('API Health Check FAILED:', error);
                alert('Backend API not available! Make sure server is running on port 3001');
            }
            
            if (window.MissionSystem) {
                window.MissionSystem.init();
            } else {
                console.error('MissionSystem not loaded!');
            }
            
            // Initialize SimpleInventory for reward collection
            if (window.SimpleInventory) {
                console.log('Initializing SimpleInventory on missions page...');
                await window.SimpleInventory.init();
            } else {
                console.error('SimpleInventory not loaded!');
            }
        });
    </script>
</body>
</html>